{% extends "base.html" %}

{% block title %}News, Blogs & Legal Insights | LandVista{% endblock %}
{% block body_class %}news-modern-body{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/news-modern.css') }}">
{% endblock %}

{% block content %}
<section class="news-modern-wrap">
    <section class="news-hero" data-reveal>
        <div class="news-hero-copy">
            <p class="news-kicker">Knowledge Hub</p>
            <h1>Market updates, legal guidance, and practical investor insights.</h1>
            <p>Follow fresh analysis on land trends, documentation readiness, and strategic location opportunities across Kenya.</p>
            <div class="news-hero-actions">
                <a href="/properties" class="news-btn-primary">View Properties</a>
                <button type="button" class="news-btn-secondary" data-open-modal="newsSubscribeModal">Join Newsletter</button>
            </div>
        </div>
        <div class="news-hero-stats">
            <article>
                <span id="newsArticleCount">0</span>
                <p>Published articles</p>
            </article>
            <article>
                <span id="newsGuideCount">0</span>
                <p>Legal guides</p>
            </article>
            <article>
                <span id="newsTopicCount">0</span>
                <p>Active topics</p>
            </article>
        </div>
    </section>

    <section class="news-featured" data-reveal>
        <div class="news-featured-head">
            <h2>Featured Update</h2>
            <div class="news-segmented" id="newsSegmented">
                <button type="button" class="active" data-type="all">All</button>
                <button type="button" data-type="article">Articles</button>
                <button type="button" data-type="guide">Legal Guides</button>
            </div>
        </div>
        <article class="news-featured-card" id="newsFeaturedCard">
            <p class="news-loading">Loading featured content...</p>
        </article>
    </section>

    <section class="news-controls" data-reveal>
        <div class="news-search-wrap">
            <i class="fas fa-magnifying-glass"></i>
            <input type="search" id="newsSearchInput" placeholder="Search by title, category, or author">
        </div>
        <select id="newsSortSelect">
            <option value="latest">Latest first</option>
            <option value="oldest">Oldest first</option>
            <option value="title">Title A-Z</option>
        </select>
        <div class="news-chip-row" id="newsCategoryChips"></div>
    </section>

    <section class="news-grid-section" data-reveal>
        <div class="news-grid-head">
            <h2>Latest Reads</h2>
            <p id="newsResultCount">0 results</p>
        </div>
        <div class="news-grid" id="newsGrid">
            <p class="news-loading">Loading content...</p>
        </div>
        <div class="news-grid-actions">
            <button type="button" id="newsLoadMoreBtn">Load more</button>
        </div>
    </section>
</section>

<div class="news-modal" id="newsPreviewModal" aria-hidden="true">
    <div class="news-modal-panel">
        <button type="button" class="news-modal-close" data-close-modal="newsPreviewModal" aria-label="Close">
            <i class="fas fa-times"></i>
        </button>
        <div id="newsPreviewContent"></div>
    </div>
</div>

<div class="news-modal" id="newsSubscribeModal" aria-hidden="true">
    <div class="news-modal-panel news-subscribe-panel">
        <button type="button" class="news-modal-close" data-close-modal="newsSubscribeModal" aria-label="Close">
            <i class="fas fa-times"></i>
        </button>
        <h3>Get Weekly Land Investment Insights</h3>
        <p>Subscribe for market updates, legal alerts, and priority listing notifications.</p>
        <form id="newsNewsletterForm" class="news-subscribe-form">
            <input type="email" name="email" placeholder="Email address" required>
            <button type="submit" id="newsNewsletterBtn">Subscribe</button>
        </form>
        <p id="newsNewsletterFeedback" class="news-feedback"></p>
    </div>
</div>
{% endblock %}

{% block socket_script %}
<script src="/socket.io/socket.io.js"></script>
{% endblock %}

{% block extra_js %}
<script>
window.newsPageData = {
    articles: {{ articles|default([], true)|tojson|safe }},
    guides: {{ guides|default([], true)|tojson|safe }}
};
</script>
<script defer src="{{ url_for('static', filename='js/news-modern.js') }}"></script>
{% endblock %}
